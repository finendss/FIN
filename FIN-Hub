local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-Ui/refs/heads/main/FIN-WindUi"))()
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local TextChatService = game:GetService("TextChatService")
local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")

local function createMainWindow()
    local Window = WindUI:CreateWindow({
        Title = "FIN-Hub",
        Icon = "rbxassetid://4483362748",
        IconTransparency = 0.5,
        IconThemed = true,
        Author = "By 鑫晴",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(400, 300),
        Transparent = true,
        Theme = "Dark",
        User = {
            Enabled = true,
            Callback = function() print("clicked") end,
            Anonymous = false
        },
        SideBarWidth = 200,
        ScrollBarEnabled = true,
        Background = "rbxassetid://1010101010"
    })
    
    local TimeTag = Window:Tag({
        Title = "00:00", --时间
        Color = Color3.fromHex("#30ff6a")
    })
    
    -- Rainbow effect & Time 
    local hue = 0
    task.spawn(function()
        while true do
            local now = os.date("*t")
            local hours = string.format("%02d", now.hour)
            local minutes = string.format("%02d", now.min)
            
            hue = (hue + 0.01) % 1
            local color = Color3.fromHSV(hue, 1, 1)
            
            TimeTag:SetTitle(hours .. ":" .. minutes)
            --TimeTag:SetColor(color)

            task.wait(0.06)
        end
    end)
    
    Window:Tag({
        Title = "缝合版",
        Color = Color3.fromHex("#315dff")
    })
    
    task.wait(0.3)

    Window:EditOpenButton({
        Title = "FIN-Hub",
        Icon = "monitor",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 2,
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),
            ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),
            ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),
            ColorSequenceKeypoint.new(1, Color3.fromHex("9400D3"))
        }),
        Draggable = true,
    })

    task.wait(0.2)

    local MainTab = Window:Tab({ --前面加这个会更好一点点
        Title = "主页",
        Icon = "zap",
        Locked = false,
    })

    MainTab:Paragraph({ --简介
        Title = "作者:鑫晴",
        Desc = "神秘的人",
    })
    MainTab:Paragraph({
        Title = "脚本为免费缝合",
        Desc = "倒卖的人死全家",
    })
    MainTab:Paragraph({
        Title = "当前服务器ID: " .. game.PlaceId,
        Desc = "感谢你的支持",
    })

    MainTab:Paragraph({
        Title = "获取FIN-Hub主群qq",
        Desc = "以此获取最新内容",
        ImageSize = 20,
        Color = "Grey",
        Buttons = {
            {
                Title = "复制",
                Icon = "copy",
                Variant = "Tertiary",
                Callback = function()
                    if type(setclipboard) == "function" then
                        setclipboard("951740588")
                        WindUI:Notify({
                            Title = "已复制",
                            Content = "已复制到剪贴板",
                            Duration = 5 --消失时长
                        })
                    else
                        WindUI:Notify({
                            Title = "错误",
                            Content = "复制功能不可用",
                            Duration = 5
                        })
                    end
                end
            }
        }
    })
    
    local Tab = Window:Tab({ --在Tab后面要加12345这样的
        Title = "通用",
        Icon = "drama",
        Locked = false,
    })

    Tab:Slider({
        Title = "奔跑速度",
        Value = {
            Min = 16,
            Max = 500,
            Default = 16,
        },
        Increment = 1,
        Callback = function(value)
            if game.Players.LocalPlayer.Character then
                local humanoid = game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.WalkSpeed = value
                end
            end
        end
    })

    Tab:Slider({
        Title = "跳跃高度",
        Value = {
            Min = 50,
            Max = 400,
            Default = 50,
        },
        Increment = 1,
        Callback = function(value)
            if game.Players.LocalPlayer.Character then
                local humanoid = game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.JumpPower = value
                end
            end
        end
    })

    Tab:Slider({
        Title = "重力(万有引力)",
        Value = {
            Min = 50,
            Max = 500,
            Default = 196,
        },
        Increment = 1,
        Callback = function(value)
            game.Workspace.Gravity = value
        end
    })

    Tab:Toggle({
        Title = "夜视",
        Default = false,
        Callback = function(Value)
            if Value then
                game.Lighting.Ambient = Color3.new(1, 1, 1)
            else
                game.Lighting.Ambient = Color3.new(0, 0, 0)
            end
        end
    })

    local Workspace = game:GetService("Workspace")
    local Players = game:GetService("Players")
    local RunService = game:GetService("RunService")

    local clipConnection = nil

    Tab:Toggle({
        Title = "穿墙",
        Default = false,
        Callback = function(enabled)
            if clipConnection then
                clipConnection:Disconnect()
                clipConnection = nil
            end
            
            if enabled then
                clipConnection = RunService.Stepped:Connect(function()
                    local char = Players.LocalPlayer.Character
                    if char then
                        for _, part in ipairs(char:GetChildren()) do
                            if part:IsA("BasePart") then
                                part.CanCollide = false
                            end
                        end
                    end
                end)
                WindUI:Notify({
                    Title = "已开启穿墙",
                    Content = "ok了老铁",
                    Duration = 3
                })
            else
                local char = Players.LocalPlayer.Character
                if char then
                    for _, part in ipairs(char:GetChildren()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = true
                        end
                    end
                end
                WindUI:Notify({
                    Title = "已关闭穿墙",
                    Content = "不ok了老铁",
                    Duration = 5
                })
            end
        end
    })

    Tab:Toggle({
        Title = "绘制玩家",
        Default = false,
        Callback = function(state)
            if state then
                local FillColor = Color3.fromRGB(255, 0, 0)
                local DepthMode = "AlwaysOnTop"
                local FillTransparency = 0.5
                local OutlineColor = Color3.fromRGB(255,255,255)
                local OutlineTransparency = 0

                local CoreGui = game:GetService("CoreGui")
                local Players = game:GetService("Players")
                local connections = {}
                
                local Storage = Instance.new("Folder")
                Storage.Parent = CoreGui
                Storage.Name = "Highlight_Storage"

                local function Highlight(plr)
                    if not Storage or not Storage.Parent then return end
                    
                    local Highlight = Instance.new("Highlight")
                    Highlight.Name = plr.Name
                    Highlight.FillColor = FillColor
                    Highlight.DepthMode = DepthMode
                    Highlight.FillTransparency = FillTransparency
                    Highlight.OutlineColor = OutlineColor
                    Highlight.OutlineTransparency = 0
                    Highlight.Parent = Storage
                    
                    local plrchar = plr.Character
                    if plrchar then
                        Highlight.Adornee = plrchar
                    end

                    connections[plr] = plr.CharacterAdded:Connect(function(char)
                        if Highlight and Highlight.Parent then
                            Highlight.Adornee = char
                        end
                    end)
                end

                connections.playerAdded = Players.PlayerAdded:Connect(Highlight)
                
                for i,v in next, Players:GetPlayers() do
                    Highlight(v)
                end

                connections.playerRemoving = Players.PlayerRemoving:Connect(function(plr)
                    if Storage and Storage.Parent then
                        local plrname = plr.Name
                        if Storage[plrname] then
                            Storage[plrname]:Destroy()
                        end
                    end
                    if connections[plr] then
                        connections[plr]:Disconnect()
                        connections[plr] = nil
                    end
                end)
                
                Storage:SetAttribute("Connections", connections)
            else
                local CoreGui = game:GetService("CoreGui")
                local Storage = CoreGui:FindFirstChild("Highlight_Storage")
                if Storage then
                    local connections = Storage:GetAttribute("Connections")
                    if connections then
                        for key, connection in pairs(connections) do
                            if connection and typeof(connection) == "RBXScriptConnection" then
                                connection:Disconnect()
                            end
                        end
                    end
                    Storage:Destroy()
                end
            end
        end
    })

    Tab:Button({
        Title = "FIN-飞行",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/FIN-Fly"))()
        end
    })

    Tab:Button({
        Title = "FIN-飞车",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/FIN-FlyCar"))()
        end
    })

    Tab:Button({
        Title = "光影 1",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/Lightandshadow-1"))()
        end
    })

    Tab:Button({
        Title = "光影 2",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/LightandShadow-2"))()
        end
    })

    Tab:Button({
        Title = "FE-死亡笔记",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/FIN-DeathNote"))()
        end
    })

    Tab:Button({
        Title = "无限跳",
        Callback = function()
            game:GetService("UserInputService").JumpRequest:Connect(function()
                local character = game:GetService("Players").LocalPlayer.Character
                if character then
                    local humanoid = character:FindFirstChildOfClass("Humanoid")
                    if humanoid then
                        humanoid:ChangeState("Jumping")
                    end
                end
            end)
            WindUI:Notify({
                Title = "已开启无限跳",
                Content = "跳跳虎",
                Duration = 3 --消失时长
            })
        end
    })

    Tab:Button({
        Title = "踏空行走",
        Callback = function()
            loadstring(game:HttpGet('https://raw.githubusercontent.com/GhostPlayer352/Test4/main/Float'))()
        end
    })

    local Tab2 = Window:Tab({
        Title = "监狱人生",
        Icon = "drama",
        Locked = false,
    })

Tab2:Button({
    Title = "子追(队伍检测)",
    Callback = function()
        local Workspace = game:GetService("Workspace")
        local Players = game:GetService("Players")
        local Teams = game:GetService("Teams")
        local LocalPlayer = Players.LocalPlayer
        local Camera = Workspace.CurrentCamera
        local old

        local FOV_Circle = Drawing.new("Circle")
        FOV_Circle.Visible = true
        FOV_Circle.Radius = 60
        FOV_Circle.Color = Color3.fromRGB(255, 255, 255)
        FOV_Circle.Thickness = 1
        FOV_Circle.Transparency = 1
        FOV_Circle.Filled = false
        FOV_Circle.Position = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)

        Camera:GetPropertyChangedSignal("ViewportSize"):Connect(function()
            FOV_Circle.Position = Vector2.new(Camera.ViewportSize.X / 2, Camera.ViewportSize.Y / 2)
        end)

        local function isEnemy(targetPlayer)
            if not targetPlayer then return true end
            local localTeam = LocalPlayer.Team
            local targetTeam = targetPlayer.Team
            if not localTeam or not targetTeam then
                return true
            end
            return localTeam ~= targetTeam
        end

        local function getClosestHead()
            local closestHead
            local closestDistance = math.huge
            local cameraDirection = Camera.CFrame.LookVector
            local cameraPos = Camera.CFrame.Position
            
            for _, player in ipairs(Players:GetPlayers()) do
                if player ~= LocalPlayer and player.Character then
                    local character = player.Character
                    local head = character:FindFirstChild("Head")
                    local humanoid = character:FindFirstChildOfClass("Humanoid")
                    local forcefield = character:FindFirstChild("ForceField")
                    
                    if head and humanoid and not forcefield and humanoid.Health > 0 and isEnemy(player) then
                        local directionToHead = (head.Position - cameraPos).Unit
                        local angle = math.deg(math.acos(cameraDirection:Dot(directionToHead)))
                        
                        if angle <= FOV_Circle.Radius then
                            local distance = (head.Position - cameraPos).Magnitude
                            if distance < closestDistance then
                                closestHead = head
                                closestDistance = distance
                            end
                        end
                    end
                end
            end
            
            return closestHead
        end

        old = hookmetamethod(game, "__namecall", function(self, ...)
            local method = getnamecallmethod()
            local args = {...}
            
            if (method == "Raycast" or method == "FindPartOnRay") and not checkcaller() and self == Workspace then
                local origin, direction
                if method == "Raycast" then
                    origin = args[1]
                    direction = args[2]
                else
                    local ray = args[1]
                    if typeof(ray) == "Ray" then
                        origin = ray.Origin
                        direction = ray.Direction
                    end
                end
                
                if origin and direction then
                    local closestHead = getClosestHead()
                    if closestHead then
                        return {
                            Instance = closestHead,
                            Position = closestHead.Position,
                            Normal = (closestHead.Position - origin).Unit,
                            Material = Enum.Material.Plastic
                        }
                    end
                end
            end
            
            return old(self, ...)
        end)

        return function()
            if old then
                hookmetamethod(game, "__namecall", old)
                old = nil
            end
            if FOV_Circle then
                FOV_Circle:Remove()
                FOV_Circle = nil
            end
        end
    end
})

    Tab2:Button({
        Title = "FE-变成钢铁侠(别人可见)",
        Callback = function()
            loadstring(game:HttpGet("https://pastebin.com/raw/7prijqYH"))()
        end
    })

    Tab2:Button({
        Title = "手里剑(秒杀别人)",
        Callback = function()
            loadstring(game:HttpGet("https://pastebin.com/raw/mSLiAZHk"))()
        end
    })

    Tab2:Button({
        Title = "FE-无敌模式(别人可见)",
        Callback = function()
            loadstring(game:HttpGet("https://pastebin.com/raw/LdTVujTA"))()
        end
    })

    Tab2:Button({
        Title = "杀死所有人(开启后无法关闭)",
        Callback = function()
            loadstring(game:HttpGet("https://pastebin.com/raw/kXjfpFPh"))()
        end
    })

    Tab2:Button({
        Title = "逮捕囚犯",
        Callback = function()
    Player = game.Players.LocalPlayer
	Pcf = Player.Character.HumanoidRootPart.CFrame
	for i,v in pairs(game.Teams.Criminals:GetPlayers()) do
	if v.Name ~= Player.Name then
	local i = 10
    repeat
    wait()
    i = i-1
    game.Workspace.Remote.arrest:InvokeServer(v.Character.HumanoidRootPart)
    Player.Character.HumanoidRootPart.CFrame = v.Character.HumanoidRootPart.CFrame * CFrame.new(0, 0, 1)
    until i == 0
end
end
        end
    })

    Tab2:Button({
        Title = "传送至警卫室",
        Callback = function()
      game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(847.7261352539062, 98.95999908447266, 2267.387451171875)
        end
    })

    Tab2:Button({
        Title = "传送至监狱室",
        Callback = function()
      game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(919.2575073242188, 98.95999908447266, 2379.74169921875)
        end
    })

    Tab2:Button({
        Title = "传送至罪犯复活点位",
        Callback = function()
      game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-937.5891723632812, 93.09876251220703, 2063.031982421875)
        end
    })

    Tab2:Button({
        Title = "传送至监狱室外",
        Callback = function()
      game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(760.6033325195312, 96.96992492675781, 2475.405029296875)
        end
    })

    local Tab3 = Window:Tab({
        Title = "自然灾害",
        Icon = "drama",
        Locked = false,
    })

    Tab3:Button({
        Title = "磁吸黑洞",
        Callback = function()
loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/Magnetic-black-hole"))()
        end
    })

    Tab3:Button({
        Title = "黑洞v1",
        Callback = function()
loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/Black-hole-v1"))()
        end
    })

    Tab3:Button({
        Title = "黑洞v2",
        Callback = function()
loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/Black-hole-v2"))()
        end
    })

    Tab3:Toggle({
        Title = "自动胜出",
        Default = true,
        Callback = function(bool)
      _G.autowinfarm = bool;
    while wait(.1) do
        if _G.autowinfarm == true then
    game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-236, 180, 360, 1, 0, 0, 0, 1, 0, 0, 0, 1)
        end
end  
        end
    })

    Tab3:Toggle({
        Title = "地图玩家投票界面",
        Default = true,
        Callback = function(bool)
    if bool == false then do game.Players.LocalPlayer.PlayerGui.MainGui.MapVotePage.Visible = false
    end
end
if bool == true then do game.Players.LocalPlayer.PlayerGui.MainGui.MapVotePage.Visible = true
    end
end
        end
    })

    Tab3:Toggle({
        Title = "水上行走",
        Default = true,
        Callback = function(bool)
     if bool == false then do game.Workspace.WaterLevel.CanCollide = false
                            game.Workspace.WaterLevel.Size = Vector3.new(10, 1, 10)
                        end
                    end
                    if bool == true then do game.Workspace.WaterLevel.CanCollide = true
                            game.Workspace.WaterLevel.Size = Vector3.new(5000, 1, 5000)
                        end
                    end
        end
    })

    Tab3:Toggle({
        Title = "游戏岛悬崖碰撞",
        Default = true,
        Callback = function(bool)
    for i, v in pairs (game.workspace:GetDescendants())do
                                if v.Name == 'LowerRocks' then
                                    v.CanCollide = bool
                                end
                            end
        end
    })

    Tab3:Button({
        Title = "禁用跌落伤害",
        Callback = function()
        local ReplicatedStorage = game:GetService("ReplicatedStorage")
        local RunService = game:GetService("RunService")
        local Players = game:GetService("Players")
        
        local hiddenfling = false
        local flingThread
        
        if not ReplicatedStorage:FindFirstChild("juisdfj0i32i0eidsuf0iok") then
            local detection = Instance.new("Decal")
            detection.Name = "juisdfj0i32i0eidsuf0iok"
            detection.Parent = ReplicatedStorage
        end
        
        local function fling()
            local lp = Players.LocalPlayer
            local c, hrp, vel, movel = nil, nil, nil, 0.1
        
            while hiddenfling do
                RunService.Heartbeat:Wait()
                c = lp.Character
                hrp = c and c:FindFirstChild("HumanoidRootPart")
        
                if hrp then
                    vel = hrp.Velocity
                    hrp.Velocity = vel * 10000 + Vector3.new(0, 10000, 0)
                    RunService.RenderStepped:Wait()
                    hrp.Velocity = vel
                    RunService.Stepped:Wait()
                    hrp.Velocity = vel + Vector3.new(0, movel, 0)
                    movel = -movel
                end
            end
        end
        
        hiddenfling = not hiddenfling
        
        if hiddenfling then
            flingThread = coroutine.create(fling)
            coroutine.resume(flingThread)
            WindUI:Notify({
                Title = "已开启防坠落伤害",
                Content = "推荐和FE-无敌少侠搭配",
                Duration = 3 --消失时长
            })
        else
            hiddenfling = false
            WindUI:Notify({
                Title = "无法关闭噢",
                Content = "我懒得搞开关",
                Duration = 3 --消失时长
            })
        end
    end
})

    Tab3:Button({
        Title = "FE-无敌少侠飞行动作",
        Callback = function()
      loadstring(game:HttpGet("https://rawscripts.net/raw/Universal-Script-Invinicible-Flight-R15-45414"))()
        end
    })

    Tab3:Button({
        Title = "传送到地图",
        Callback = function()
      game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-115.828506, 65.4863434, 18.8461514, 0.00697017973, 0.0789371505, -0.996855199, -3.13589936e-07, 0.996879458, 0.0789390653, 0.999975681, -0.000549906865, 0.00694845384)
        end
    })

    Tab3:Button({
        Title = "传送到游戏岛",
        Callback = function()
      game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-83.5, 38.5, -27.5, -1, 0, 0, 0, 1, 0, 0, 0, -1)
        end
    })

    Tab3:Button({
        Title = "传送到产卵塔",
        Callback = function()
      game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = CFrame.new(-280, 170, 341, 1, 0, 0, 0, 1, 0, 0, 0, 1)
        end
    })

    local Tab4 = Window:Tab({
        Title = "被遗弃",
        Icon = "drama",
        Locked = false,
    })

    Tab4:Button({
        Title = "FartSaken(汉化)",
        Callback = function()
 loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/Chinese/refs/heads/main/Fartsaken%20Chinese"))()
        end
    })

    Tab4:Button({
        Title = "SntSaken(半汉化)",
        Callback = function()
 loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/Chinese/refs/heads/main/SNTSaken"))()
        end
    })

    Tab4:Toggle({
        Title = "绘制杀手",
        Default = false,
        Callback = function()
          for _, ESP in workspace.Players.Killers:GetChildren() do
       local h = lnstance.new("Highlight")
       h.FillColor = Color3.new(1.0.0)
       h.FillTransparency = 0
       h.Parent = ESP
       end
        end
    })
end

WindUI:Popup({
    Title = "FIN-v1-Hub",
    Icon = "sparkles",
    Content = "尊敬的：" .. game.Players.LocalPlayer.Name,
    Buttons = {
        {
            Title = "启动",
            Icon = "arrow-right",
            Variant = "Primary",
            Callback = function()
                print("启动")
                createMainWindow()
            end
        }
    }
})
