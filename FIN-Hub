local WindUI = loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-Ui/refs/heads/main/FIN-WindUi"))()
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local TextChatService = game:GetService("TextChatService")
local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")

local function createMainWindow()
    local Window = WindUI:CreateWindow({
        Title = "FIN-Hub",
        Icon = "rbxassetid://4483362748",
        IconTransparency = 0.5,
        IconThemed = true,
        Author = "By 鑫晴",
        Folder = "CloudHub",
        Size = UDim2.fromOffset(400, 300),
        Transparent = true,
        Theme = "Dark",
        User = {
            Enabled = true,
            Callback = function() print("clicked") end,
            Anonymous = false
        },
        SideBarWidth = 200,
        ScrollBarEnabled = true,
        Background = "rbxassetid://1010101010"
    })
    
    local TimeTag = Window:Tag({
        Title = "00:00", --时间
        Color = Color3.fromHex("#30ff6a")
    })
    
    -- Rainbow effect & Time 
    local hue = 0
    task.spawn(function()
        while true do
            local now = os.date("*t")
            local hours = string.format("%02d", now.hour)
            local minutes = string.format("%02d", now.min)
            
            hue = (hue + 0.01) % 1
            local color = Color3.fromHSV(hue, 1, 1)
            
            TimeTag:SetTitle(hours .. ":" .. minutes)
            --TimeTag:SetColor(color)

            task.wait(0.06)
        end
    end)
    
    Window:Tag({
        Title = "缝合版",
        Color = Color3.fromHex("#315dff")
    })
    
    task.wait(0.3)

    Window:EditOpenButton({
        Title = "FIN-Hub",
        Icon = "monitor",
        CornerRadius = UDim.new(0,16),
        StrokeThickness = 2,
        Color = ColorSequence.new({
            ColorSequenceKeypoint.new(0, Color3.fromHex("FF0000")),
            ColorSequenceKeypoint.new(0.66, Color3.fromHex("0000FF")),
            ColorSequenceKeypoint.new(0.83, Color3.fromHex("4B0082")),
            ColorSequenceKeypoint.new(1, Color3.fromHex("9400D3"))
        }),
        Draggable = true,
    })

    task.wait(0.2)

    local MainTab = Window:Tab({ --前面加这个会更好一点点
        Title = "主页",
        Icon = "zap",
        Locked = false,
    })

    MainTab:Paragraph({ --简介
        Title = "作者:鑫晴",
        Desc = "神秘的人",
    })
    MainTab:Paragraph({
        Title = "脚本为免费缝合",
        Desc = "倒卖的人死全家",
    })
    MainTab:Paragraph({
        Title = "当前服务器ID: " .. game.PlaceId,
        Desc = "感谢你的支持",
    })

    MainTab:Paragraph({
        Title = "获取FIN-Hub主群qq",
        Desc = "以此获取最新内容",
        ImageSize = 20,
        Color = "Grey",
        Buttons = {
            {
                Title = "复制",
                Icon = "copy",
                Variant = "Tertiary",
                Callback = function()
                    if type(setclipboard) == "function" then
                        setclipboard("951740588")
                        WindUI:Notify({
                            Title = "已复制",
                            Content = "已复制到剪贴板",
                            Duration = 5 --消失时长
                        })
                    else
                        WindUI:Notify({
                            Title = "错误",
                            Content = "复制功能不可用",
                            Duration = 5
                        })
                    end
                end
            }
        }
    })
    
    local Tab = Window:Tab({ --在Tab后面要加12345这样的
        Title = "通用",
        Icon = "drama",
        Locked = false,
    })

    Tab:Slider({
        Title = "奔跑速度",
        Value = {
            Min = 16,
            Max = 500,
            Default = 16,
        },
        Increment = 1,
        Callback = function(value)
            if game.Players.LocalPlayer.Character then
                local humanoid = game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.WalkSpeed = value
                end
            end
        end
    })

    Tab:Slider({
        Title = "跳跃高度",
        Value = {
            Min = 50,
            Max = 400,
            Default = 50,
        },
        Increment = 1,
        Callback = function(value)
            if game.Players.LocalPlayer.Character then
                local humanoid = game.Players.LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.JumpPower = value
                end
            end
        end
    })

    Tab:Slider({
        Title = "重力(万有引力)",
        Value = {
            Min = 50,
            Max = 500,
            Default = 196,
        },
        Increment = 1,
        Callback = function(value)
            game.Workspace.Gravity = value
        end
    })

    Tab:Toggle({
        Title = "夜视",
        Default = false,
        Callback = function(Value)
            if Value then
                game.Lighting.Ambient = Color3.new(1, 1, 1)
            else
                game.Lighting.Ambient = Color3.new(0, 0, 0)
            end
        end
    })

    local Workspace = game:GetService("Workspace")
    local Players = game:GetService("Players")
    local RunService = game:GetService("RunService")

    local clipConnection = nil

    Tab:Toggle({
        Title = "穿墙",
        Default = false,
        Callback = function(enabled)
            if clipConnection then
                clipConnection:Disconnect()
                clipConnection = nil
            end
            
            if enabled then
                clipConnection = RunService.Stepped:Connect(function()
                    local char = Players.LocalPlayer.Character
                    if char then
                        for _, part in ipairs(char:GetChildren()) do
                            if part:IsA("BasePart") then
                                part.CanCollide = false
                            end
                        end
                    end
                end)
                WindUI:Notify({
                    Title = "已开启穿墙",
                    Content = "ok了老铁",
                    Duration = 3
                })
            else
                local char = Players.LocalPlayer.Character
                if char then
                    for _, part in ipairs(char:GetChildren()) do
                        if part:IsA("BasePart") then
                            part.CanCollide = true
                        end
                    end
                end
                WindUI:Notify({
                    Title = "已关闭穿墙",
                    Content = "不ok了老铁",
                    Duration = 5
                })
            end
        end
    })

    Tab:Toggle({
        Title = "绘制玩家",
        Default = false,
        Callback = function(state)
            if state then
                local FillColor = Color3.fromRGB(255, 0, 0)
                local DepthMode = "AlwaysOnTop"
                local FillTransparency = 0.5
                local OutlineColor = Color3.fromRGB(255,255,255)
                local OutlineTransparency = 0

                local CoreGui = game:GetService("CoreGui")
                local Players = game:GetService("Players")
                local connections = {}
                
                local Storage = Instance.new("Folder")
                Storage.Parent = CoreGui
                Storage.Name = "Highlight_Storage"

                local function Highlight(plr)
                    if not Storage or not Storage.Parent then return end
                    
                    local Highlight = Instance.new("Highlight")
                    Highlight.Name = plr.Name
                    Highlight.FillColor = FillColor
                    Highlight.DepthMode = DepthMode
                    Highlight.FillTransparency = FillTransparency
                    Highlight.OutlineColor = OutlineColor
                    Highlight.OutlineTransparency = 0
                    Highlight.Parent = Storage
                    
                    local plrchar = plr.Character
                    if plrchar then
                        Highlight.Adornee = plrchar
                    end

                    connections[plr] = plr.CharacterAdded:Connect(function(char)
                        if Highlight and Highlight.Parent then
                            Highlight.Adornee = char
                        end
                    end)
                end

                connections.playerAdded = Players.PlayerAdded:Connect(Highlight)
                
                for i,v in next, Players:GetPlayers() do
                    Highlight(v)
                end

                connections.playerRemoving = Players.PlayerRemoving:Connect(function(plr)
                    if Storage and Storage.Parent then
                        local plrname = plr.Name
                        if Storage[plrname] then
                            Storage[plrname]:Destroy()
                        end
                    end
                    if connections[plr] then
                        connections[plr]:Disconnect()
                        connections[plr] = nil
                    end
                end)
                
                Storage:SetAttribute("Connections", connections)
            else
                local CoreGui = game:GetService("CoreGui")
                local Storage = CoreGui:FindFirstChild("Highlight_Storage")
                if Storage then
                    local connections = Storage:GetAttribute("Connections")
                    if connections then
                        for key, connection in pairs(connections) do
                            if connection and typeof(connection) == "RBXScriptConnection" then
                                connection:Disconnect()
                            end
                        end
                    end
                    Storage:Destroy()
                end
            end
        end
    })

    Tab:Button({
        Title = "FIN-飞行",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/FIN-Fly"))()
        end
    })

    Tab:Button({
        Title = "FIN-飞车",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/FIN-FlyCar"))()
        end
    })

    Tab:Button({
        Title = "光影 1",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/Lightandshadow-1"))()
        end
    })

    Tab:Button({
        Title = "光影 2",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/LightandShadow-2"))()
        end
    })

    Tab:Button({
        Title = "FE-死亡笔记",
        Callback = function()
            loadstring(game:HttpGet("https://raw.githubusercontent.com/finendss/FIN-function/refs/heads/main/FIN-DeathNote"))()
        end
    })

    Tab:Button({
        Title = "无限跳",
        Callback = function()
            game:GetService("UserInputService").JumpRequest:Connect(function()
                local character = game:GetService("Players").LocalPlayer.Character
                if character then
                    local humanoid = character:FindFirstChildOfClass("Humanoid")
                    if humanoid then
                        humanoid:ChangeState("Jumping")
                    end
                end
            end)
            WindUI:Notify({
                Title = "已开启无限跳",
                Content = "跳跳虎",
                Duration = 3 --消失时长
            })
        end
    })

    Tab:Button({
        Title = "踏空行走",
        Callback = function()
            loadstring(game:HttpGet('https://raw.githubusercontent.com/GhostPlayer352/Test4/main/Float'))()
        end
    })

    local Tab2 = Window:Tab({
        Title = "监狱人生",
        Icon = "drama",
        Locked = false,
    })

    Tab2:Button({
        Title = "FE-变成钢铁侠(别人可见)",
        Callback = function()
            loadstring(game:HttpGet("https://pastebin.com/raw/7prijqYH"))()
        end
    })

    Tab2:Button({
        Title = "手里剑(秒杀别人)",
        Callback = function()
            loadstring(game:HttpGet("https://pastebin.com/raw/mSLiAZHk"))()
        end
    })

    Tab2:Button({
        Title = "FE-无敌模式(别人可见)",
        Callback = function()
            loadstring(game:HttpGet("https://pastebin.com/raw/LdTVujTA"))()
        end
    })


WindUI:Popup({
    Title = "FIN-v1-Hub",
    Icon = "sparkles",
    Content = "尊敬的：" .. game.Players.LocalPlayer.Name,
    Buttons = {
        {
            Title = "启动",
            Icon = "arrow-right",
            Variant = "Primary",
            Callback = function()
                print("启动")
                createMainWindow()
            end
        }
    }
})
